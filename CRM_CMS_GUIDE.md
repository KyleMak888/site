# CRM & CMS åŠŸèƒ½è¯´æ˜ / CRM & CMS Feature Guide

## ğŸ“… åˆ›å»ºæ—¥æœŸ: 2024-10-30

---

## ğŸ“‹ æ¦‚è¿° / Overview

æœ¬é¡¹ç›®å®ç°äº†åŸºæœ¬çš„CRMï¼ˆå®¢æˆ·å…³ç³»ç®¡ç†ï¼‰å’ŒCMSï¼ˆå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰åŠŸèƒ½ï¼Œç”¨äºï¼š
- ğŸ“ æ”¶é›†å’Œç®¡ç†å®¢æˆ·å’¨è¯¢ä¿¡æ¯
- ğŸ“Š ç®¡ç†ç½‘ç«™å†…å®¹ï¼ˆæ¡ˆä¾‹ã€æœåŠ¡ã€é¦–é¡µæ•°æ®ï¼‰
- ğŸ”’ ç®€å•çš„ç®¡ç†åå°è®¤è¯

---

## ğŸ—‚ï¸ æ–‡ä»¶ç»“æ„

```
project/
â”œâ”€â”€ data/                          # æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ cms/                       # CMSå†…å®¹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ cases.json            # æ¡ˆä¾‹æ•°æ®
â”‚   â”‚   â””â”€â”€ home.json             # é¦–é¡µæ•°æ®
â”‚   â””â”€â”€ submissions/               # è¡¨å•æäº¤æ•°æ®
â”‚       â”œâ”€â”€ contacts.json         # æ‰€æœ‰è”ç³»è¡¨å•æäº¤
â”‚       â””â”€â”€ contact_*.json        # å•ä¸ªæäº¤è¯¦æƒ…
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ contact/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts      # è”ç³»è¡¨å•API
â”‚   â”‚   â”‚   â””â”€â”€ cms/
â”‚   â”‚   â”‚       â””â”€â”€ cases/
â”‚   â”‚   â”‚           â””â”€â”€ route.ts  # æ¡ˆä¾‹æ•°æ®API
â”‚   â”‚   â”œâ”€â”€ contact/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx          # è”ç³»é¡µé¢
â”‚   â”‚   â””â”€â”€ admin/
â”‚   â”‚       â””â”€â”€ page.tsx          # CRMç®¡ç†åå°
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ sections/
â”‚   â”‚       â””â”€â”€ contact-form.tsx  # è”ç³»è¡¨å•ç»„ä»¶
â”‚   â”‚
â”‚   â””â”€â”€ lib/
â”‚       â””â”€â”€ cms/
â”‚           â””â”€â”€ loader.ts         # CMSæ•°æ®åŠ è½½å·¥å…·
â”‚
â””â”€â”€ CRM_CMS_GUIDE.md              # æœ¬æ–‡ä»¶
```

---

## ğŸš€ åŠŸèƒ½è¯¦è§£

### 1. CRM - å®¢æˆ·å…³ç³»ç®¡ç†

#### 1.1 è”ç³»è¡¨å•æäº¤

**å‰ç«¯è¡¨å•**: `/contact`

ç”¨æˆ·å¯ä»¥å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š
- âœ… å§“åï¼ˆå¿…å¡«ï¼‰
- âœ… é‚®ç®±ï¼ˆå¿…å¡«ï¼‰
- âœ… å…¬å¸ï¼ˆå¿…å¡«ï¼‰
- ğŸ“± ç”µè¯ï¼ˆå¯é€‰ï¼‰
- ğŸ’° é¢„ç®—èŒƒå›´ï¼ˆå¯é€‰ï¼‰
- ğŸ’¬ é¡¹ç›®éœ€æ±‚ï¼ˆå¯é€‰ï¼‰

**APIç«¯ç‚¹**: `POST /api/contact`

```typescript
// è¯·æ±‚ç¤ºä¾‹
{
  "name": "å¼ ä¸‰",
  "email": "zhang@example.com",
  "company": "æŸæŸå…¬å¸",
  "phone": "13800138000",
  "budget": "100k-300k",
  "message": "æˆ‘ä»¬éœ€è¦å¼€å‘ä¸€ä¸ªå°ç¨‹åº..."
}

// å“åº”ç¤ºä¾‹
{
  "success": true,
  "message": "æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ï¼Œæˆ‘ä»¬ä¼šå°½å¿«ä¸æ‚¨è”ç³»ï¼",
  "submissionId": "1234567890_abc123"
}
```

**æ•°æ®éªŒè¯**:
- å§“åè‡³å°‘2ä¸ªå­—ç¬¦
- é‚®ç®±æ ¼å¼æ ¡éªŒ
- å…¬å¸åç§°è‡³å°‘2ä¸ªå­—ç¬¦
- ç”µè¯å·ç æ ¼å¼æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰

**æ•°æ®å­˜å‚¨**:
```
data/submissions/
â”œâ”€â”€ contacts.json              # æ‰€æœ‰æäº¤çš„æ±‡æ€»
â””â”€â”€ contact_1234567890_abc.json  # å•ä¸ªæäº¤è¯¦æƒ…
```

#### 1.2 CRMç®¡ç†åå°

**è®¿é—®åœ°å€**: `/admin`

**è®¤è¯æ–¹å¼**: APIå¯†é’¥è®¤è¯

**é»˜è®¤å¯†é’¥**: `admin-secret-key` ï¼ˆâš ï¸ ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿®æ”¹ï¼‰

**åŠŸèƒ½**:
- ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰æäº¤è®°å½•
- ğŸ” æŸ¥çœ‹æäº¤è¯¦æƒ…
- ğŸ“§ å¿«é€Ÿè”ç³»ï¼ˆç‚¹å‡»é‚®ç®±/ç”µè¯ï¼‰
- ğŸ“… æäº¤æ—¶é—´æ’åº

**ä½¿ç”¨æ­¥éª¤**:
1. è®¿é—® `/admin`
2. è¾“å…¥APIå¯†é’¥
3. æŸ¥çœ‹æäº¤åˆ—è¡¨
4. ç‚¹å‡»é‚®ç®±/ç”µè¯è”ç³»å®¢æˆ·

---

### 2. CMS - å†…å®¹ç®¡ç†ç³»ç»Ÿ

#### 2.1 æ•°æ®ç»“æ„

**æ¡ˆä¾‹æ•°æ®**: `data/cms/cases.json`

```json
{
  "id": "case-sams-club",
  "title": "å±±å§†ä¼šå‘˜å•†åº—å°ç¨‹åº",
  "titleEn": "Sam's Club Mini Program",
  "client": "å±±å§†ä¼šå‘˜å•†åº—",
  "industry": "é›¶å”®è¡Œä¸š",
  "slug": "sams-club-mini-program",
  "summary": "...",
  "challenge": "...",
  "solution": "...",
  "results": [
    { "metric": "é¡µé¢åŠ è½½é€Ÿåº¦", "value": "-60%", "description": "..." }
  ],
  "technologies": ["WeChat Mini Program", "React"],
  "duration": "3 ä¸ªæœˆ",
  "coverImage": "/images/case/app-sams-club.png",
  "featured": true
}
```

**é¦–é¡µæ•°æ®**: `data/cms/home.json`

```json
{
  "hero": {
    "headline": "æŠ€æœ¯é©±åŠ¨çš„å“ç‰Œè¥é”€",
    "highlight": "ä¸æ•°å­—äº§å“",
    "description": "...",
    "primaryCta": { "label": "è·å–æ¡ˆä¾‹åŒ…", "href": "#cases" }
  },
  "stats": [...],
  "clients": [...],
  "services": [...]
}
```

#### 2.2 CMS API

**è·å–æ‰€æœ‰æ¡ˆä¾‹**: `GET /api/cms/cases`

```typescript
// å“åº”
{
  "success": true,
  "data": [
    { id: "case-1", title: "...", ... },
    { id: "case-2", title: "...", ... }
  ]
}
```

**è·å–ç²¾é€‰æ¡ˆä¾‹**: `GET /api/cms/cases?featured=true`

```typescript
// å“åº”
{
  "success": true,
  "data": [
    { id: "case-1", title: "...", featured: true, ... }
  ]
}
```

**è·å–å•ä¸ªæ¡ˆä¾‹**: `GET /api/cms/cases?slug=sams-club-mini-program`

```typescript
// å“åº”
{
  "success": true,
  "data": {
    id: "case-sams-club",
    title: "å±±å§†ä¼šå‘˜å•†åº—å°ç¨‹åº",
    ...
  }
}
```

#### 2.3 CMSæ•°æ®åŠ è½½å·¥å…·

**ä½¿ç”¨æ–¹æ³•**:

```typescript
import { getAllCases, getFeaturedCases, getCaseBySlug, getHomeData } from "@/lib/cms/loader";

// åœ¨Server Componentä¸­ä½¿ç”¨
export default function Page() {
  const cases = getAllCases();
  const featured = getFeaturedCases();
  const homeData = getHomeData();
  const singleCase = getCaseBySlug("sams-club-mini-program");
  
  return <div>...</div>;
}
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env.local`:

```env
# CRMç®¡ç†åå°APIå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ï¼‰
ADMIN_API_KEY=your-secure-api-key-here

# ç½‘ç«™URL
NEXT_PUBLIC_SITE_URL=https://yourdomain.com

# å…¶ä»–é…ç½®...
```

### ä¿®æ”¹APIå¯†é’¥

1. æ‰“å¼€ `.env.local`
2. ä¿®æ”¹ `ADMIN_API_KEY` çš„å€¼
3. é‡å¯å¼€å‘æœåŠ¡å™¨

**æˆ–è€…ç›´æ¥ä¿®æ”¹ä»£ç **:

```typescript
// src/app/api/contact/route.ts
const validToken = process.env.ADMIN_API_KEY || "your-new-key-here";
```

---

## ğŸ“Š æ•°æ®ç®¡ç†

### æ·»åŠ æ–°æ¡ˆä¾‹

ç¼–è¾‘ `data/cms/cases.json`ï¼Œæ·»åŠ æ–°å¯¹è±¡ï¼š

```json
{
  "id": "case-new-project",
  "title": "æ–°é¡¹ç›®æ ‡é¢˜",
  "titleEn": "New Project Title",
  "client": "å®¢æˆ·åç§°",
  "industry": "è¡Œä¸š",
  "slug": "new-project-slug",
  "summary": "é¡¹ç›®ç®€ä»‹...",
  "challenge": "é¢ä¸´çš„æŒ‘æˆ˜...",
  "solution": "è§£å†³æ–¹æ¡ˆ...",
  "results": [
    { "metric": "æŒ‡æ ‡", "value": "+50%", "description": "è¯´æ˜" }
  ],
  "technologies": ["æŠ€æœ¯1", "æŠ€æœ¯2"],
  "duration": "2 ä¸ªæœˆ",
  "coverImage": "/images/case/new-project.png",
  "featured": true,
  "publishedAt": "2024-01-01",
  "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"]
}
```

### ä¿®æ”¹é¦–é¡µå†…å®¹

ç¼–è¾‘ `data/cms/home.json`ï¼š

```json
{
  "hero": {
    "headline": "ä¿®æ”¹åçš„æ ‡é¢˜",
    "description": "ä¿®æ”¹åçš„æè¿°..."
  },
  "stats": [
    {
      "id": "new-stat",
      "metric": "+200%",
      "title": "æ–°æŒ‡æ ‡",
      "description": "è¯´æ˜"
    }
  ]
}
```

### æŸ¥çœ‹æäº¤æ•°æ®

**æ–¹æ³•1**: é€šè¿‡ç®¡ç†åå°ï¼ˆæ¨èï¼‰
- è®¿é—® `/admin`
- è¾“å…¥APIå¯†é’¥
- æŸ¥çœ‹æ‰€æœ‰æäº¤

**æ–¹æ³•2**: ç›´æ¥æŸ¥çœ‹æ–‡ä»¶
```bash
cat data/submissions/contacts.json
```

**æ–¹æ³•3**: ä½¿ç”¨API
```bash
curl -H "Authorization: Bearer admin-secret-key" \
  http://localhost:3000/api/contact
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰å¿…åšï¼š

1. **ä¿®æ”¹APIå¯†é’¥**
   ```env
   ADMIN_API_KEY=your-long-random-secure-key-here-min-32-chars
   ```

2. **é™åˆ¶ç®¡ç†åå°è®¿é—®**
   - æ·»åŠ IPç™½åå•
   - ä½¿ç”¨VPN
   - æ·»åŠ æ›´å¼ºçš„è®¤è¯ï¼ˆå¦‚OAuthï¼‰

3. **æ•°æ®å¤‡ä»½**
   ```bash
   # å®šæœŸå¤‡ä»½æ•°æ®ç›®å½•
   tar -czf data-backup-$(date +%Y%m%d).tar.gz data/
   ```

4. **ç›‘æ§æäº¤**
   - æ·»åŠ ååƒåœ¾æœºåˆ¶
   - æ·»åŠ éªŒè¯ç ï¼ˆreCAPTCHAï¼‰
   - é™åˆ¶æäº¤é¢‘ç‡

5. **HTTPS**
   - ç¡®ä¿ç”Ÿäº§ç¯å¢ƒä½¿ç”¨HTTPS
   - é˜²æ­¢APIå¯†é’¥æ³„éœ²

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å®¢æˆ·å’¨è¯¢

1. å®¢æˆ·è®¿é—® `/contact`
2. å¡«å†™è¡¨å•æäº¤
3. æ•°æ®ä¿å­˜åˆ° `data/submissions/`
4. ç®¡ç†å‘˜ç™»å½• `/admin` æŸ¥çœ‹
5. é€šè¿‡é‚®ç®±/ç”µè¯è”ç³»å®¢æˆ·

### åœºæ™¯2: æ›´æ–°æ¡ˆä¾‹

1. ç¼–è¾‘ `data/cms/cases.json`
2. æ·»åŠ æ–°æ¡ˆä¾‹æˆ–ä¿®æ”¹ç°æœ‰æ¡ˆä¾‹
3. ä¿å­˜æ–‡ä»¶
4. åˆ·æ–°ç½‘ç«™ï¼Œå†…å®¹è‡ªåŠ¨æ›´æ–°

### åœºæ™¯3: ä¿®æ”¹é¦–é¡µå†…å®¹

1. ç¼–è¾‘ `data/cms/home.json`
2. ä¿®æ”¹æ–‡æ¡ˆã€æ•°æ®ã€é“¾æ¥ç­‰
3. ä¿å­˜æ–‡ä»¶
4. åˆ·æ–°é¦–é¡µæŸ¥çœ‹æ•ˆæœ

---

## ğŸ”„ å·¥ä½œæµç¨‹

### æ—¥å¸¸å·¥ä½œæµ

```
1. å®¢æˆ·æäº¤è¡¨å•
   â†“
2. ç³»ç»ŸéªŒè¯å¹¶ä¿å­˜æ•°æ®
   â†“
3. ç®¡ç†å‘˜æ”¶åˆ°é€šçŸ¥ï¼ˆå¯é€‰ï¼šé‚®ä»¶æé†’ï¼‰
   â†“
4. ç™»å½•åå°æŸ¥çœ‹è¯¦æƒ…
   â†“
5. è”ç³»å®¢æˆ·è·Ÿè¿›
```

### å†…å®¹æ›´æ–°æµ

```
1. ç¼–è¾‘JSONæ•°æ®æ–‡ä»¶
   â†“
2. ä¿å­˜å¹¶æäº¤åˆ°Git
   â†“
3. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
   â†“
4. ç½‘ç«™å†…å®¹è‡ªåŠ¨æ›´æ–°
```

---

## ğŸ“ˆ æ‰©å±•å»ºè®®

### çŸ­æœŸæ”¹è¿›

1. **é‚®ä»¶é€šçŸ¥**
   - è¡¨å•æäº¤åå‘é€é‚®ä»¶é€šçŸ¥ç®¡ç†å‘˜
   - ä½¿ç”¨ Nodemailer æˆ– SendGrid

2. **éªŒè¯ç **
   - æ·»åŠ  reCAPTCHA v3
   - é˜²æ­¢åƒåœ¾æäº¤

3. **å¯¼å‡ºåŠŸèƒ½**
   - å¯¼å‡ºæäº¤æ•°æ®ä¸ºCSV
   - å¯¼å‡ºä¸ºExcel

### ä¸­æœŸæ”¹è¿›

1. **æ•°æ®åº“é›†æˆ**
   - ä»JSONæ–‡ä»¶è¿ç§»åˆ°æ•°æ®åº“ï¼ˆPostgreSQL/MySQLï¼‰
   - ä½¿ç”¨Prisma ORM

2. **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨**
   - åœ¨ç®¡ç†åå°æ·»åŠ å¯è§†åŒ–ç¼–è¾‘å™¨
   - ç›´æ¥ç¼–è¾‘æ¡ˆä¾‹å’Œå†…å®¹

3. **å›¾ç‰‡ä¸Šä¼ **
   - æ”¯æŒç›´æ¥ä¸Šä¼ æ¡ˆä¾‹å›¾ç‰‡
   - é›†æˆäº‘å­˜å‚¨ï¼ˆé˜¿é‡Œäº‘OSS/AWS S3ï¼‰

### é•¿æœŸæ”¹è¿›

1. **å®Œæ•´CMSç³»ç»Ÿ**
   - ç”¨æˆ·æƒé™ç®¡ç†
   - å†…å®¹ç‰ˆæœ¬æ§åˆ¶
   - å·¥ä½œæµå®¡æ‰¹

2. **é«˜çº§CRM**
   - å®¢æˆ·çŠ¶æ€è·Ÿè¸ª
   - é”€å”®æ¼æ–—
   - è‡ªåŠ¨åŒ–è¥é”€

3. **åˆ†æé¢æ¿**
   - æäº¤æ¥æºåˆ†æ
   - è½¬åŒ–ç‡ç»Ÿè®¡
   - ç”¨æˆ·è¡Œä¸ºåˆ†æ

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: è¡¨å•æäº¤å¤±è´¥ï¼Ÿ
**A**: æ£€æŸ¥ï¼š
1. ç½‘ç»œè¿æ¥
2. APIè·¯ç”±æ˜¯å¦æ­£ç¡®
3. æ•°æ®éªŒè¯æ˜¯å¦é€šè¿‡
4. æœåŠ¡å™¨æ—¥å¿—

### Q2: ç®¡ç†åå°æ— æ³•ç™»å½•ï¼Ÿ
**A**: æ£€æŸ¥ï¼š
1. APIå¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®
3. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### Q3: æ¡ˆä¾‹æ•°æ®ä¸æ˜¾ç¤ºï¼Ÿ
**A**: æ£€æŸ¥ï¼š
1. JSONæ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
2. æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. æ˜¯å¦é‡å¯äº†å¼€å‘æœåŠ¡å™¨

### Q4: å›¾ç‰‡æ— æ³•æ˜¾ç¤ºï¼Ÿ
**A**: æ£€æŸ¥ï¼š
1. å›¾ç‰‡è·¯å¾„æ˜¯å¦ä»¥ `/` å¼€å¤´
2. å›¾ç‰‡æ–‡ä»¶æ˜¯å¦åœ¨ `public/images/` ä¸‹
3. æ–‡ä»¶æ‰©å±•åæ˜¯å¦æ­£ç¡®

---

## ğŸ“š APIå‚è€ƒ

### POST /api/contact

**åŠŸèƒ½**: æäº¤è”ç³»è¡¨å•

**è¯·æ±‚ä½“**:
```json
{
  "name": "string (required, min: 2)",
  "email": "string (required, valid email)",
  "company": "string (required, min: 2)",
  "phone": "string (optional)",
  "budget": "string (optional)",
  "message": "string (optional)"
}
```

**å“åº”**:
```json
// æˆåŠŸ
{
  "success": true,
  "message": "æ„Ÿè°¢æ‚¨çš„å’¨è¯¢...",
  "submissionId": "1234567890_abc"
}

// å¤±è´¥
{
  "success": false,
  "errors": ["é”™è¯¯ä¿¡æ¯1", "é”™è¯¯ä¿¡æ¯2"]
}
```

### GET /api/contact

**åŠŸèƒ½**: è·å–æ‰€æœ‰æäº¤ï¼ˆéœ€è®¤è¯ï¼‰

**è¯·æ±‚å¤´**:
```
Authorization: Bearer your-api-key
```

**å“åº”**:
```json
{
  "success": true,
  "data": [
    {
      "id": "...",
      "timestamp": "2024-10-30T12:00:00.000Z",
      "name": "...",
      "email": "...",
      ...
    }
  ]
}
```

### GET /api/cms/cases

**åŠŸèƒ½**: è·å–æ¡ˆä¾‹æ•°æ®

**æŸ¥è¯¢å‚æ•°**:
- `featured=true`: ä»…è·å–ç²¾é€‰æ¡ˆä¾‹
- `slug=xxx`: è·å–ç‰¹å®šæ¡ˆä¾‹

**å“åº”**:
```json
{
  "success": true,
  "data": [ /* æ¡ˆä¾‹æ•°ç»„ */ ]
}
```

---

## ğŸ‰ æ€»ç»“

æœ¬CRM&CMSç³»ç»Ÿæä¾›äº†ï¼š
- âœ… åŸºæœ¬çš„è¡¨å•æäº¤å’Œç®¡ç†åŠŸèƒ½
- âœ… ç®€å•çš„å†…å®¹ç®¡ç†ç³»ç»Ÿ
- âœ… ç®¡ç†åå°è®¤è¯
- âœ… JSONæ–‡ä»¶å­˜å‚¨ï¼ˆæ˜“äºè¿ç§»ï¼‰
- âœ… RESTful APIæ¥å£
- âœ… TypeScriptç±»å‹å®‰å…¨

è™½ç„¶åŠŸèƒ½ç®€å•ï¼Œä½†è¶³ä»¥æ»¡è¶³åŸºæœ¬çš„ä¸šåŠ¡éœ€æ±‚ï¼Œä¸”æ˜“äºæ‰©å±•å’Œè¿ç§»åˆ°æ›´å¤æ‚çš„ç³»ç»Ÿã€‚

---

**åˆ›å»ºæ—¶é—´**: 2024-10-30  
**æœ€åæ›´æ–°**: 2024-10-30  
**ç»´æŠ¤è€…**: AI Assistant
